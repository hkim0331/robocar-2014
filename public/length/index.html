<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'/>
    <title>index.md—/Users/hkim/Dropbox/robocar-2014/public/length</title>
    <style type="text/css">
    body{font-family:Helvetica,arial,sans-serif;font-size:14px;line-height:1.6;padding-top:10px;padding-bottom:10px;background-color:white;padding:30px;color:#333}body>*:first-child{margin-top:0!important}body>*:last-child{margin-bottom:0!important}a{color:#4183c4;text-decoration:none}a:hover{text-decoration:underline}a.absent{color:#c00}a.anchor{display:block;padding-left:30px;margin-left:-30px;cursor:pointer;position:absolute;top:0;left:0;bottom:0}html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0}kbd{background:#f1f1f1;background:-moz-linear-gradient(#f1f1f1,#ddd);background:-webkit-linear-gradient(#f1f1f1,#ddd);-ms-filter:"progid:DXImageTransform.Microsoft.gradient(startColorstr='#f1f1f1', endColorstr='#dddddd')";border-radius:2px;border:1px solid #ddd;border-bottom-color:#ccc;border-right-color:#ccc;padding:1px 4px;line-height:10px;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}.container{max-width:920px;margin:0 auto 20px auto}#header{background:#fafafa;background:-moz-linear-gradient(#fafafa,#eaeaea);background:-webkit-linear-gradient(#fafafa,#eaeaea);-ms-filter:"progid:DXImageTransform.Microsoft.gradient(startColorstr='#fafafa', endColorstr='#eaeaea')";border-bottom:1px solid #cacaca;box-shadow:0 1px 0 rgba(255,255,255,0.4),0 0 10px rgba(0,0,0,0.1)}#markup{padding:3px}#markup article{padding-top:30px}.markdown-body{font-size:14px;line-height:1.6}.markdown-body>*:first-child{margin-top:0!important}.markdown-body>*:last-child{margin-bottom:0!important}.markdown-body a.absent{color:#c00}.markdown-body a.anchor{bottom:0;cursor:pointer;display:block;left:0;margin-left:-30px;padding-left:30px;position:absolute;top:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{cursor:text;font-weight:bold;margin:20px 0 10px;padding:0;position:relative}.markdown-body h1 .mini-icon-link,.markdown-body h2 .mini-icon-link,.markdown-body h3 .mini-icon-link,.markdown-body h4 .mini-icon-link,.markdown-body h5 .mini-icon-link,.markdown-body h6 .mini-icon-link{color:#000;display:none}.markdown-body h1:hover a.anchor,.markdown-body h2:hover a.anchor,.markdown-body h3:hover a.anchor,.markdown-body h4:hover a.anchor,.markdown-body h5:hover a.anchor,.markdown-body h6:hover a.anchor{line-height:1;margin-left:-22px;padding-left:0;text-decoration:none;top:15%}.markdown-body h1:hover a.anchor .mini-icon-link,.markdown-body h2:hover a.anchor .mini-icon-link,.markdown-body h3:hover a.anchor .mini-icon-link,.markdown-body h4:hover a.anchor .mini-icon-link,.markdown-body h5:hover a.anchor .mini-icon-link,.markdown-body h6:hover a.anchor .mini-icon-link{display:inline-block}.markdown-body h1 tt,.markdown-body h1 code,.markdown-body h2 tt,.markdown-body h2 code,.markdown-body h3 tt,.markdown-body h3 code,.markdown-body h4 tt,.markdown-body h4 code,.markdown-body h5 tt,.markdown-body h5 code,.markdown-body h6 tt,.markdown-body h6 code{font-size:inherit}.markdown-body h1{color:#000;font-size:28px}.markdown-body h2{border-bottom:1px solid #ccc;color:#000;font-size:24px}.markdown-body h3{font-size:18px}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:14px}.markdown-body h6{color:#777;font-size:14px}.markdown-body p,.markdown-body blockquote,.markdown-body ul,.markdown-body ol,.markdown-body dl,.markdown-body table,.markdown-body pre{margin:15px 0}.markdown-body hr{background:url("/public/github-dirty-shade.png") repeat-x scroll 0 0 transparent;border:0 none;color:#ccc;height:4px;padding:0}.markdown-body>h2:first-child,.markdown-body>h1:first-child,.markdown-body>h1:first-child+h2,.markdown-body>h3:first-child,.markdown-body>h4:first-child,.markdown-body>h5:first-child,.markdown-body>h6:first-child{margin-top:0;padding-top:0}.markdown-body a:first-child h1,.markdown-body a:first-child h2,.markdown-body a:first-child h3,.markdown-body a:first-child h4,.markdown-body a:first-child h5,.markdown-body a:first-child h6{margin-top:0;padding-top:0}.markdown-body h1+p,.markdown-body h2+p,.markdown-body h3+p,.markdown-body h4+p,.markdown-body h5+p,.markdown-body h6+p{margin-top:0}.markdown-body li p.first{display:inline-block}.markdown-body ul,.markdown-body ol{padding-left:30px}.markdown-body ul.no-list,.markdown-body ol.no-list{list-style-type:none;padding:0}.markdown-body ul li>*:first-child,.markdown-body ol li>*:first-child{margin-top:0}.markdown-body ul ul,.markdown-body ul ol,.markdown-body ol ol,.markdown-body ol ul{margin-bottom:0}.markdown-body dl{padding:0}.markdown-body dl dt{font-size:14px;font-style:italic;font-weight:bold;margin:15px 0 5px;padding:0}.markdown-body dl dt:first-child{padding:0}.markdown-body dl dt>*:first-child{margin-top:0}.markdown-body dl dt>*:last-child{margin-bottom:0}.markdown-body dl dd{margin:0 0 15px;padding:0 15px}.markdown-body dl dd>*:first-child{margin-top:0}.markdown-body dl dd>*:last-child{margin-bottom:0}.markdown-body blockquote{border-left:4px solid #ddd;color:#777;padding:0 15px}.markdown-body blockquote>*:first-child{margin-top:0}.markdown-body blockquote>*:last-child{margin-bottom:0}.markdown-body table{border-collapse:collapse;border-spacing:0}.markdown-body table th{font-weight:bold}.markdown-body table th,.markdown-body table td{border:1px solid #ccc;padding:6px 13px}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{border:1px solid #ddd;display:block;float:left;margin:13px 0 0;overflow:hidden;padding:7px;width:auto}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{clear:both;color:#333;display:block;padding:5px 0 0}.markdown-body span.align-center{clear:both;display:block;overflow:hidden}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{clear:both;display:block;overflow:hidden}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{background-color:#f8f8f8;border:1px solid #eaeaea;border-radius:3px 3px 3px 3px;margin:0 2px;padding:0 5px;white-space:nowrap}.markdown-body pre>code{background:none repeat scroll 0 0 transparent;border:medium none;margin:0;padding:0;white-space:pre}.markdown-body .highlight pre,.markdown-body pre{background-color:#f8f8f8;border:1px solid #ccc;border-radius:3px 3px 3px 3px;font-size:13px;line-height:19px;overflow:auto;padding:6px 10px}.markdown-body pre code,.markdown-body pre tt{background-color:transparent;border:medium none}.codehilite{background:#fff}.codehilite .c{color:#998;font-style:italic}.codehilite .err{color:#a61717;background-color:#e3d2d2}.codehilite .k{color:#000;font-weight:bold}.codehilite .o{color:#000;font-weight:bold}.codehilite .cm{color:#998;font-style:italic}.codehilite .cp{color:#999;font-weight:bold}.codehilite .c1{color:#998;font-style:italic}.codehilite .cs{color:#999;font-weight:bold;font-style:italic}.codehilite .gd{color:#000;background-color:#fdd}.codehilite .gd .x{color:#000;background-color:#faa}.codehilite .ge{color:#000;font-style:italic}.codehilite .gr{color:#a00}.codehilite .gh{color:#999}.codehilite .gi{color:#000;background-color:#dfd}.codehilite .gi .x{color:#000;background-color:#afa}.codehilite .go{color:#888}.codehilite .gp{color:#555}.codehilite .gs{font-weight:bold}.codehilite .gu{color:#aaa}.codehilite .gt{color:#a00}.codehilite .kc{color:#000;font-weight:bold}.codehilite .kd{color:#000;font-weight:bold}.codehilite .kp{color:#000;font-weight:bold}.codehilite .kr{color:#000;font-weight:bold}.codehilite .kt{color:#458;font-weight:bold}.codehilite .m{color:#099}.codehilite .s{color:#d14}.codehilite .na{color:#008080}.codehilite .nb{color:#0086b3}.codehilite .nc{color:#458;font-weight:bold}.codehilite .no{color:#008080}.codehilite .ni{color:#800080}.codehilite .ne{color:#900;font-weight:bold}.codehilite .nf{color:#900;font-weight:bold}.codehilite .nn{color:#555}.codehilite .nt{color:#000080}.codehilite .nv{color:#008080}.codehilite .ow{color:#000;font-weight:bold}.codehilite .w{color:#bbb}.codehilite .mf{color:#099}.codehilite .mh{color:#099}.codehilite .mi{color:#099}.codehilite .mo{color:#099}.codehilite .sb{color:#d14}.codehilite .sc{color:#d14}.codehilite .sd{color:#d14}.codehilite .s2{color:#d14}.codehilite .se{color:#d14}.codehilite .sh{color:#d14}.codehilite .si{color:#d14}.codehilite .sx{color:#d14}.codehilite .sr{color:#009926}.codehilite .s1{color:#d14}.codehilite .ss{color:#990073}.codehilite .bp{color:#999}.codehilite .vc{color:#008080}.codehilite .vg{color:#008080}.codehilite .vi{color:#008080}.codehilite .il{color:#099}
    </style>
    <style type="text/css">
      .markdown-body hr{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC")}
    </style>
  </head>
  <body>
    <div class="container">
      <div id="markup">
        <article id="content" class="markdown-body">
          <h2>長さを測れ</h2>
<div>
  <img src="data:image/png;base64,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" style='width:60%;'>
</div>

<p>黒エリアの長さを求めたい。
左下から右上への黒線に乗ってロボカーを動かすのだが、</p>
<ol>
<li>最初の短い本黒線は踏み越し、</li>
<li>真ん中の長い黒エリアの中を前進、</li>
<li>右上の黒エリアの向こう側エッジ（白白）で停止したい。</li>
</ol>
<p>授業は聞いてるだけじゃダメ。考えてっか？
クリックして
<a href="ideas.cgi">自分の考えを述べよ</a>。分析的に、筋道立てて。</p>
<h2>step を応用する</h2>
<p>ロボカーの動作を 「5mm ずつステップ」に戻す。この方がプログラムが簡単になる。</p>
<div class="codehilite"><pre><span class="cp">#include &quot;LPC13xx.h&quot;</span>
<span class="cp">#include &quot;gpio.h&quot;</span>
<span class="cp">#include &quot;vs-wrc103.h&quot;</span>
<span class="cp">#include &quot;ixbus.h&quot;</span>

<span class="cp">#define LEFT_POWER  10000</span>
<span class="cp">#define RIGHT_POWER 10000</span>
<span class="cp">#define LEFT    1</span>
<span class="cp">#define RIGHT   0</span>

<span class="cp">#define LED_LEFT 2</span>
<span class="cp">#define LED_RIGHT 1</span>

<span class="cp">#define MM 20       </span><span class="c1">// 1mm 進むための時間</span>
<span class="cp">#define BLACK 500   </span><span class="c1">// 白黒判断の境界値</span>

<span class="kt">void</span> <span class="nf">motor</span><span class="p">(</span><span class="kt">short</span> <span class="n">left</span><span class="p">,</span> <span class="kt">short</span> <span class="n">right</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Mtr_Run_lv</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="o">-</span><span class="n">right</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">stop</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">motor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">forward</span><span class="p">(</span><span class="kt">int</span> <span class="n">mm</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">LED</span><span class="p">(</span><span class="n">LED_LEFT</span> <span class="o">+</span> <span class="n">LED_RIGHT</span><span class="p">);</span>
    <span class="n">motor</span><span class="p">(</span><span class="n">LEFT_POWER</span><span class="p">,</span> <span class="n">RIGHT_POWER</span><span class="p">);</span>
    <span class="n">Wait</span><span class="p">(</span><span class="n">MM</span> <span class="o">*</span> <span class="n">mm</span><span class="p">);</span>
    <span class="n">stop</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">turn</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="n">dir</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">dir</span> <span class="o">==</span> <span class="n">LEFT</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">LED</span><span class="p">(</span><span class="n">LED_LEFT</span><span class="p">);</span>
        <span class="n">motor</span><span class="p">(</span><span class="n">LEFT_POWER</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="n">RIGHT_POWER</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">dir</span> <span class="o">==</span> <span class="n">RIGHT</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">LED</span><span class="p">(</span><span class="n">LED_RIGHT</span><span class="p">);</span>
        <span class="n">motor</span><span class="p">(</span><span class="n">LEFT_POWER</span><span class="p">,</span><span class="n">RIGHT_POWER</span><span class="o">/</span><span class="mi">3</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">step</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">forward</span><span class="p">(</span><span class="n">n</span><span class="p">);</span> <span class="c1">// forward nmm</span>
    <span class="n">stop</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">is_black</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">ADRead</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">BLACK</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">is_white</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">!</span> <span class="n">is_black</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">MainCycle</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>
    <span class="n">Init</span><span class="p">(</span><span class="n">MainCycle</span><span class="p">);</span>

    <span class="n">Wait</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(;;)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">is_white</span><span class="p">(</span><span class="n">LEFT</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">is_white</span><span class="p">(</span><span class="n">RIGHT</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">step</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
            <span class="n">Wait</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span> <span class="c1">// この Wait() は動作が完成したら削ろう。</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">is_black</span><span class="p">(</span><span class="n">LEFT</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">is_black</span><span class="p">(</span><span class="n">RIGHT</span><span class="p">))</span> <span class="p">{</span>
            <span class="p">;</span> <span class="c1">// このときどうするか？</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">is_black</span><span class="p">(</span><span class="n">LEFT</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">turn</span><span class="p">(</span><span class="n">LEFT</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">is_black</span><span class="p">(</span><span class="n">RIGHT</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">turn</span><span class="p">(</span><span class="n">RIGHT</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="p">;</span> <span class="c1">// 安全のための else</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">stop</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<h3>問題</h3>
<p>プログラムは良さげで良くない。
黒線をはさんでステップしていて、黒黒になった状況でロボカーがどんな動作をするか、予測し、説明しなさい。</p>
<h2>黒線の長さを測る</h2>
<p>整数型の変数 blacks を準備し、5mm 進むごとに連続何回、黒黒をカウントするかを数えよう。
黒テープの幅は 18mm。４つ以上黒黒が続いたら「長い黒」だ。</p>
<div class="codehilite"><pre>    <span class="p">...</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">is_black</span><span class="p">(</span><span class="n">LEFT</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">is_black</span><span class="p">(</span><span class="n">RIGHT</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">blacks</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="n">step</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">blacks</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">stop</span><span class="p">();</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">blacks</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
                <span class="p">;</span> <span class="c1">// ライントレースの方法を変えねば。白黒、黒白の時に曲がる方向が逆だ。</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="p">...</span>
</pre></div>


<h3>初期化は重要</h3>
<p>変数の名前はかなり自由に付けられる。
しかし、意味のある変数名を選ばないとあとでプログラムの内容がわからなくなる。</p>
<div class="codehilite"><pre><span class="kt">int</span> <span class="n">blacks</span><span class="p">;</span>
</pre></div>


<p>さて、上の変数 blacks の値はいくらでしょう？　正解は「決まってない」です。
多くの初心者が「ゼロになる」と思い込んで痛い目にあっています。</p>
<p>黒黒が連続する回数を数えたいんだから、ループに入る前と、黒黒以外になったとき、変数 blacks は 0 にリセットしないといけない。さて、それはどこか？正解をグループ内で確認すること。</p>
<h2>黒枠内を進むには</h2>
<p>プログラム中、コメントで書いたが、ライントレースしているときと、黒枠中を進むときは、
白黒、黒白を見たときに曲がる方向が違う。ちゃんとプログラムしないとな。</p>
<h2>音で知らせる問題</h2>
<p>踏み越した黒の長さをブザーで知らせろ。１cmはプッ、３cmはプップップッのように。</p>
<h2>模様を測定する --- 配列が利用できれば</h2>
<p>ロボカーを一定の時間（あるいは黒３cmエリアまで）動かす。
動作開始後、停止するまでのグラウンドの状況を音で報告させろ。
配列に step ごとの白黒を記録し、動作完了したら配列に記録されたデータに従って音出しすればいい。</p>
<h2>ステップをあえてやめる</h2>
<p>ステップすれば黒線長さを測るのは比較的楽。ステップやめても長さを測れるようにせよ。</p>
<h2></h2>
<p>written by hkimura.</p>
        </article>
      </div>
    </div>
  </body>
</html>
